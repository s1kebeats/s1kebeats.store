import{d as h,o as p,c as m,t as S,w as q,a as P,r as B,b as $,n as v,u as y,F as w,e as f,f as k,g as _,h as A,i as T,j as L,k as O,l as Q,m as n,p as g,v as b,q as j,s as M}from"./index.72e3de7e.js";import{L as N,_ as I,a as E}from"./BeatstoreBeatShimmer.vue_vue_type_script_setup_true_lang.c48bd96d.js";function F(l,o){o.forEach(s=>{l.classList.toggle(s)})}const R=h({__name:"BeatstoreArtist",props:{artist:null},emits:["selectArtist"],setup(l,{emit:o}){const s=e=>{o("selectArtist",e)};return(e,r)=>(p(),m("button",{"data-test":"artist",onClick:r[0]||(r[0]=q(a=>s(l.artist.id),["prevent"])),class:"flex-1 px-2 h-[24px] text-xs rounded-lg shadow-md text-white flex justify-center items-center min-w-[90px] max-w-[110px] box-border hover:bg-black transition-all"},S(l.artist.name),1))}}),U=h({__name:"BeatstoreArtistList",props:{list:null},emits:["selectArtist"],setup(l,{emit:o}){const s=k(),e=P(()=>s.query.artist&&typeof s.query.artist=="string"?s.query.artist.split(",").map(a=>+a):[]),r=a=>{o("selectArtist",a)};return(a,i)=>l.list?(p(!0),m(w,{key:0},B(l.list,c=>(p(),$(R,{artist:c,key:c.id,onSelectArtist:r,class:v(y(e).includes(c.id)?"bg-black":"bg-primary")},null,8,["artist","class"]))),128)):(p(),m(w,{key:1},B([{},{},{},{}],c=>f(N,{class:"rounded-lg border-none min-w-[90px] max-w-[110px] h-[24px] flex-1"})),64))}}),V={key:0},z=h({__name:"BeatstoreArtists",emits:["updateArtistQuery"],setup(l,{emit:o}){const s=k(),e=_(s.query.artist&&typeof s.query.artist=="string"?s.query.artist.split(",").map(t=>+t):[]),r=t=>{e.value.includes(t)?e.value=e.value.filter(d=>d!==t):e.value.push(t),o("updateArtistQuery",e.value)};A(()=>{e.value.length&&o("updateArtistQuery",e.value)});const{isLoading:a,isError:i,data:c,error:u}=T("artists",()=>L.get("https://s1kebeatstore-rest.herokuapp.com/api/artists/"),{staleTime:1e3*60*5});return(t,d)=>y(i)?(p(),m("span",V,"Error: "+S(y(u)),1)):(p(),$(U,{key:1,onSelectArtist:r,list:y(a)?null:y(c).data.results},null,8,["list"]))}}),D={"data-test":"searchPanel",class:"flex justify-center box-border responsive pb-5"},G={class:"w-full flex flex-wrap gap-3"},H={class:"flex items-center gap-1 bpm w-[100px]"},J=["value","onInput"],K=n("label",{for:"bpm",class:"text-sm text-black"}," BPM ",-1),W={class:"flex items-center gap-2 flex-1 min-w-[170px] max-w-[200px]"},X=["value"],Y=h({__name:"BeatstoreSearchPanel",emits:["updateSearchQuery"],setup(l,{emit:o}){const s=k(),e=O({bpm:s.query.bpm?String(s.query.bpm):"",name:s.query.name?String(s.query.name):"",artist:[]});function r(t){e.artist=t}let a;function i(t){const d=t.target;d.value=d.value.replace(/[^\d,]/g,""),clearTimeout(a),c=setTimeout(()=>{e.bpm=d.value},500)}let c;function u(t){const d=t.target;clearTimeout(c),c=setTimeout(()=>{e.name=d.value},750)}return Q(e,()=>{const t={};e.bpm&&(t.bpm=e.bpm),e.name&&(t.name=e.name),e.artist.length&&(t.artist=e.artist.join(",")),o("updateSearchQuery",t)}),(t,d)=>(p(),m("div",D,[n("form",G,[n("fieldset",H,[n("input",{id:"bpm","data-test":"bpmInput",type:"number",size:"3",name:"bpm",min:"1",max:"300",placeholder:"1",value:e.bpm,onInput:q(i,["prevent"]),class:"w-full input input-xs input-bordered focus:outline-none text-black"},null,40,J),K]),n("fieldset",W,[n("input",{id:"name","data-test":"nameInput",type:"text",placeholder:"name",name:"nm",value:e.name,onInput:u,class:"w-full input input-xs input-bordered input-primar focus:outline-none focus:border-base-300 text-black"},null,40,X)]),f(z,{onUpdateArtistQuery:r})])]))}}),Z={class:"relative"},ee=n("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M112 184l144 144 144-144"},null,-1),te=[ee],se=h({__name:"BeatstoreOrderings",emits:["changeOrdering"],setup(l,{emit:o}){const s=_(),e=_(),r=_(!1),a=_(),i=_("-id"),c=d=>{i.value!==d&&(i.value=d,r.value=!1,o("changeOrdering",i.value))},u=()=>{r.value=!r.value},t=()=>{document.activeElement!==s.value&&document.activeElement!==e.value&&setTimeout(()=>{r.value=!1},100)};return(d,x)=>(p(),m("div",Z,[n("button",{ref:"orderingButton","data-test":"orderingButton",onClick:u,onFocusout:t,class:"flex hover:text-black px-2 rounded-lg text-sm h-[24px] items-center gap-1"},[n("span",{"data-test":"orderingText",class:v(r.value?"text-black":"")},S(i.value==="-id"?"New first":"Popular first"),3),(p(),m("svg",{ref:"orderingSvg","data-test":"orderingDown",xmlns:"http://www.w3.org/2000/svg",class:v(["ionicon w-[16px] transition-all",r.value?"rotate-180":""]),viewBox:"0 -40 512 512"},te,2))],544),g(n("div",{ref_key:"orderingsPanel",ref:a,class:"absolute z-[2] w-[115px] border-full border-[1px] bg-base-100 rounded-md p-2 flex flex-col gap-1 shadow-md right-0"},[n("button",{ref_key:"orderOption1",ref:s,onClick:x[0]||(x[0]=C=>c("-listenings")),class:v(["w-full flex hover:text-black px-2 rounded-lg text-sm items-center gap-1",i.value=="-listenings"?"text-black":""])}," Popular first ",2),n("button",{ref_key:"orderOption2",ref:e,onClick:x[1]||(x[1]=C=>c("-id")),class:v(["w-full flex hover:text-black px-2 rounded-lg text-sm items-center gap-1",i.value=="-id"?"text-black":""])}," New first ",2)],512),[[b,r.value]])]))}}),ae={class:"flex justify-between items-center responsive"},re=n("h1",{class:"text-left text-xl font-semibold mt-5 mb-4 text-black"},"Beats",-1),ne={class:"flex items-center gap-1"},oe=j(" Filters "),le=n("svg",{xmlns:"http://www.w3.org/2000/svg",class:"ionicon w-[14px]",viewBox:"0 -30 512 512"},[n("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M32 144h448M112 256h288M208 368h96"})],-1),ie=[oe,le],ce=h({__name:"BeatstoreSearch",emits:["search"],setup(l,{emit:o}){const s=k(),e=_(!1),r=u=>{const t=u.target;e.value=!e.value,F(t,["text-black"])},a=O({ordering:s.query.ordering?String(s.query.ordering):"-id"}),i=u=>{a.ordering=u,o("search",`?${new URLSearchParams(a).toString()}`)},c=u=>{"bpm"in u||delete a.bpm,"name"in u||delete a.name,"artist"in u||delete a.artist,Object.assign(a,u),o("search",`?${new URLSearchParams(a).toString()}`)};return(u,t)=>(p(),m(w,null,[n("div",ae,[re,n("div",ne,[f(se,{onChangeOrdering:i}),n("button",{"data-test":"searchButton",class:"flex hover:text-black px-2 rounded-lg text-sm h-[24px] items-center gap-[6px]",onClick:r},ie)])]),g(f(Y,{onUpdateSearchQuery:c},null,512),[[b,e.value]])],64))}}),ue={"data-test":"beatList",class:"flex flex-col responsive"},de={class:"flex flex-wrap gap-5"},pe={"data-test":"nothingFound",class:"text-md text-black text-center pt-2"},me=h({__name:"BeatstoreBeatList",props:{list:null},setup(l){return(o,s)=>(p(),m("div",ue,[g(n("div",de,[(p(!0),m(w,null,B(l.list,e=>(p(),$(I,{key:e.id?e.id:0,beat:e},null,8,["beat"]))),128))],512),[[b,l.list.length]]),g(n("p",pe," Nothing was found ",512),[[b,!l.list.length]])]))}});const _e={class:"flex-1 flex flex-col items-center pt-5 pb-[75px] min-h-[calc(100vh-85px)]"},he=h({__name:"BeatstoreBeats",setup(l){const o=M(),s=k(),e=_(!0),r=_(""),a=_([]),i=async(t,d)=>{e.value=!0;const x=(await L.get(t)).data;d?a.value.push(...x.results):a.value=[...x.results],r.value=x.next,e.value=!1},c=async t=>{o.push(`/beats${t}`)},u=()=>{i(r.value,!0)};return Q(()=>s.query,()=>{const t=s.query;i(`https://s1kebeatstore-rest.herokuapp.com/api/beats/?${new URLSearchParams(t).toString()}`)}),A(()=>{const t=s.query;i(`https://s1kebeatstore-rest.herokuapp.com/api/beats/?${new URLSearchParams(t).toString()}`)}),(t,d)=>(p(),m("section",_e,[f(ce,{onSearch:c}),g(f(me,{class:"flex-1",list:a.value},null,8,["list"]),[[b,!e.value]]),g(f(E,{class:"self-start"},null,512),[[b,e.value]]),g(n("button",{"data-test":"loadmoreButton",onClick:u,class:"btn bg-black text-white hover:bg-black btn-xs shadow-lg hover:brightness-95 transition-all mt-5"}," Load more ",512),[[b,r.value]])]))}}),ge=h({__name:"BeatsView",setup(l){return(o,s)=>(p(),$(he))}});export{ge as default};
