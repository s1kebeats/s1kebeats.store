import{d as g,o as m,c as x,t as q,w as A,a as T,r as L,b as C,n as y,u as I,F as S,e as k,f as d,g as Q,h as P,i as b,v,j as h,k as F,l as O,m as j,p as n,q as R,s as U}from"./index.0245f7c0.js";import{L as V,_ as $}from"./BeatList.vue_vue_type_style_index_0_lang.8d3a792e.js";function E(i,o){o.forEach(a=>{i.classList.toggle(a)})}const z=g({__name:"BeatstoreArtist",props:{artist:null},emits:["selectArtist"],setup(i,{emit:o}){const a=e=>{o("selectArtist",e)};return(e,l)=>(m(),x("button",{"data-test":"artist",onClick:l[0]||(l[0]=A(s=>a(i.artist.id?i.artist.id:null),["prevent"])),class:"flex-1 px-2 h-[24px] text-xs rounded-lg shadow-md text-white flex justify-center items-center min-w-[90px] max-w-[110px] box-border hover:bg-black transition-all"},q(i.artist.name),1))}}),D=g({__name:"ArtistList",props:{artistList:null},emits:["selectArtist"],setup(i,{emit:o}){const a=k(),e=T(()=>a.query.artist&&typeof a.query.artist=="string"?a.query.artist.split(",").map(s=>+s):[]),l=s=>{o("selectArtist",s)};return(s,u)=>(m(!0),x(S,null,L(i.artistList,r=>(m(),C(z,{artist:r,key:r.id?r.id:0,onSelectArtist:l,class:y(I(e).includes(r.id)?"bg-black":"bg-primary")},null,8,["artist","class"]))),128))}}),G=g({__name:"BeatstoreArtists",emits:["updateArtistQuery"],setup(i,{emit:o}){const a=k(),e=d(a.query.artist&&typeof a.query.artist=="string"?a.query.artist.split(",").map(r=>+r):[]),l=r=>{e.value.includes(r)?e.value=e.value.filter(f=>f!==r):e.value.push(r),o("updateArtistQuery",e.value)},s=d(!0),u=d([]);return Q(async()=>{u.value=(await P.get("https://s1kebeatstore-rest.herokuapp.com/api/artists/")).data.results,s.value=!1,e.value.length&&o("updateArtistQuery",e.value)}),(r,f)=>(m(),x(S,null,[b(h(D,{onSelectArtist:l,"artist-list":u.value},null,8,["artist-list"]),[[v,!s.value]]),s.value?(m(),x(S,{key:0},L([{},{},{},{}],t=>h(V,{"data-test":"placeholder",class:"rounded-lg border-none min-w-[90px] max-w-[110px] h-[24px] flex-1 hover:bg-base-300"})),64)):F("",!0)],64))}}),H={"data-test":"searchPanel",class:"flex justify-center box-border responsive pb-5"},J={class:"w-full flex flex-wrap gap-3"},K={class:"flex items-center gap-1 bpm w-[100px]"},W=["value","onInput"],X=n("label",{for:"bpm",class:"text-sm text-black"}," BPM ",-1),Y={class:"flex items-center gap-2 flex-1 min-w-[170px] max-w-[200px]"},Z=["value"],ee=g({__name:"BeatstoreSearchPanel",emits:["updateSearchQuery"],setup(i,{emit:o}){const a=k(),e=O({bpm:a.query.bpm?String(a.query.bpm):"",name:a.query.name?String(a.query.name):"",artist:[]});function l(t){e.artist=t}let s;function u(t){const c=t.target;c.value=c.value.replace(/[^\d,]/g,""),clearTimeout(s),r=setTimeout(()=>{e.bpm=c.value},500)}let r;function f(t){const c=t.target;clearTimeout(r),r=setTimeout(()=>{e.name=c.value},750)}return j(e,()=>{const t={};e.bpm&&(t.bpm=e.bpm),e.name&&(t.name=e.name),e.artist&&e.artist.length&&(t.artist=e.artist.join(",")),o("updateSearchQuery",t)}),(t,c)=>(m(),x("div",H,[n("form",J,[n("fieldset",K,[n("input",{id:"bpm","data-test":"bpmInput",type:"number",size:"3",name:"bpm",min:"1",max:"300",placeholder:"1",value:e.bpm,onInput:A(u,["prevent"]),class:"w-full input input-xs input-bordered focus:outline-none text-black"},null,40,W),X]),n("fieldset",Y,[n("input",{id:"name","data-test":"nameInput",type:"text",placeholder:"name",name:"nm",value:e.name,onInput:f,class:"w-full input input-xs input-bordered input-primar focus:outline-none focus:border-base-300 text-black"},null,40,Z)]),h(G,{onUpdateArtistQuery:l})])]))}}),te={class:"flex justify-between items-center responsive"},se=n("h1",{class:"text-left text-xl font-semibold mt-5 mb-4 text-black"},"Beats",-1),ae={class:"flex items-center gap-1"},re={class:"relative"},ne=n("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M112 184l144 144 144-144"},null,-1),oe=[ne],le=R(" Filters "),ie=n("svg",{xmlns:"http://www.w3.org/2000/svg",class:"ionicon w-[14px]",viewBox:"0 -30 512 512"},[n("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M32 144h448M112 256h288M208 368h96"})],-1),ue=[le,ie],ce=g({__name:"BeatstoreSearch",emits:["search"],setup(i,{emit:o}){const a=k(),e=d(!1),l=p=>{const _=p.target;e.value=!e.value,E(_,["text-black"])},s=O({ordering:a.query.ordering?String(a.query.ordering):"-id"}),u=p=>{s.ordering!==p&&(s.ordering=p,t.value=!1,B(s))},r=d(),f=d(),t=d(!1),c=d(),w=()=>{t.value=!t.value},M=()=>{document.activeElement!==r.value&&document.activeElement!==f.value&&setTimeout(()=>{t.value=!1},100)},B=p=>{"bpm"in p||delete s.bpm,"name"in p||delete s.name,"artist"in p||delete s.artist,Object.assign(s,p),o("search",`?${new URLSearchParams(s).toString()}`)};return(p,_)=>(m(),x(S,null,[n("div",te,[se,n("div",ae,[n("div",re,[n("button",{ref:"orderingButton","data-test":"orderingButton",onClick:w,onFocusout:M,class:"flex hover:text-black px-2 rounded-lg text-sm h-[24px] items-center gap-1"},[n("span",{"data-test":"orderingText",class:y(t.value?"text-black":"")},q(s.ordering==="-id"?"New first":"Popular first"),3),(m(),x("svg",{ref:"orderingSvg","data-test":"orderingDown",xmlns:"http://www.w3.org/2000/svg",class:y(["ionicon w-[16px] transition-all",t.value?"rotate-180":""]),viewBox:"0 -40 512 512"},oe,2))],544),b(n("div",{ref_key:"orderingsPanel",ref:c,class:"absolute z-[2] w-[115px] border-full border-[1px] bg-base-100 rounded-md p-2 flex flex-col gap-1 shadow-md right-0"},[n("button",{ref_key:"orderOption1",ref:r,onClick:_[0]||(_[0]=N=>u("-listenings")),class:y(["w-full flex hover:text-black px-2 rounded-lg text-sm items-center gap-1",s.ordering=="-listenings"?"text-black":""])}," Popular first ",2),n("button",{ref_key:"orderOption2",ref:f,onClick:_[1]||(_[1]=N=>u("-id")),class:y(["w-full flex hover:text-black px-2 rounded-lg text-sm items-center gap-1",s.ordering=="-id"?"text-black":""])}," New first ",2)],512),[[v,t.value]])]),n("button",{"data-test":"searchButton",class:"flex hover:text-black px-2 rounded-lg text-sm h-[24px] items-center gap-[6px]",onClick:l},ue)])]),b(h(ee,{onUpdateSearchQuery:B},null,512),[[v,e.value]])],64))}}),de={class:"flex-1 flex flex-col items-center pt-5 pb-[75px] min-h-[calc(100vh-85px)]"},pe=g({__name:"BeatstoreBeats",setup(i){const o=U(),a=k(),e=d(!0),l=d(""),s=d([]),u=async(t,c)=>{e.value=!0;const w=(await P.get(t)).data;c?s.value.push(...w.results):s.value=[...w.results],l.value=w.next,e.value=!1},r=async t=>{o.push(`/beats${t}`)},f=()=>{u(l.value,!0)};return j(()=>a.query,()=>{const t=a.query;u(`https://s1kebeatstore-rest.herokuapp.com/api/beats/?${new URLSearchParams(t).toString()}`)}),Q(()=>{const t=a.query;u(`https://s1kebeatstore-rest.herokuapp.com/api/beats/?${new URLSearchParams(t).toString()}`)}),(t,c)=>(m(),x("section",de,[h(ce,{onSearch:r}),b(h($,{class:"flex-1",list:s.value},null,8,["list"]),[[v,!e.value]]),b(h($,{"data-test":"placeholderList",class:"flex-1",list:[{}]},null,512),[[v,e.value]]),b(n("button",{"data-test":"loadmoreButton",onClick:f,class:"btn bg-black text-white hover:bg-black btn-xs shadow-lg hover:brightness-95 transition-all mt-5"}," Load more ",512),[[v,l.value]])]))}}),xe=g({__name:"BeatsView",setup(i){return(o,a)=>(m(),C(pe))}});export{xe as default};
