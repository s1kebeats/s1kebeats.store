import{d as h,o as d,c as f,t as $,w as Q,a as N,r as C,b as B,n as v,u as y,F as q,e as S,f as m,g as P,h as E,i as b,j as O,k as T,l as j,m as a,p as k,v as w,q as F,s as R}from"./index.f3c44899.js";import{L as U,_ as L}from"./BeatList.vue_vue_type_style_index_0_lang.c0d2945e.js";function V(c,n){n.forEach(r=>{c.classList.toggle(r)})}const z=h({__name:"BeatstoreArtist",props:{artist:null},emits:["selectArtist"],setup(c,{emit:n}){const r=e=>{n("selectArtist",e)};return(e,i)=>(d(),f("button",{"data-test":"artist",onClick:i[0]||(i[0]=Q(s=>r(c.artist.id?c.artist.id:null),["prevent"])),class:"flex-1 px-2 h-[24px] text-xs rounded-lg shadow-md text-white flex justify-center items-center min-w-[90px] max-w-[110px] box-border hover:bg-black transition-all"},$(c.artist.name),1))}}),D=h({__name:"ArtistList",props:{artistList:null},emits:["selectArtist"],setup(c,{emit:n}){const r=S(),e=N(()=>r.query.artist&&typeof r.query.artist=="string"?r.query.artist.split(",").map(s=>+s):[]),i=s=>{n("selectArtist",s)};return(s,u)=>(d(!0),f(q,null,C(c.artistList,o=>(d(),B(z,{artist:o,key:o.id?o.id:0,onSelectArtist:i,class:v(y(e).includes(o.id)?"bg-black":"bg-primary")},null,8,["artist","class"]))),128))}}),G={key:1},H=h({__name:"BeatstoreArtists",emits:["updateArtistQuery"],setup(c,{emit:n}){const r=S(),e=m(r.query.artist&&typeof r.query.artist=="string"?r.query.artist.split(",").map(t=>+t):[]),i=t=>{e.value.includes(t)?e.value=e.value.filter(l=>l!==t):e.value.push(t),n("updateArtistQuery",e.value)};P(()=>{e.value.length&&n("updateArtistQuery",e.value)});const{isLoading:s,isError:u,data:o,error:x}=E("artists",()=>O.get("https://s1kebeatstore-rest.herokuapp.com/api/artists/"),{staleTime:1e3*60*5});return(t,l)=>y(s)?(d(),f(q,{key:0},C([{},{},{},{}],g=>b(U,{"data-test":"placeholder",class:"rounded-lg border-none min-w-[90px] max-w-[110px] h-[24px] flex-1 hover:bg-base-300"})),64)):y(u)?(d(),f("span",G,"Error: "+$(y(x)),1)):(d(),B(D,{key:2,onSelectArtist:i,"artist-list":y(o).data.results},null,8,["artist-list"]))}}),J={"data-test":"searchPanel",class:"flex justify-center box-border responsive pb-5"},K={class:"w-full flex flex-wrap gap-3"},W={class:"flex items-center gap-1 bpm w-[100px]"},X=["value","onInput"],Y=a("label",{for:"bpm",class:"text-sm text-black"}," BPM ",-1),Z={class:"flex items-center gap-2 flex-1 min-w-[170px] max-w-[200px]"},ee=["value"],te=h({__name:"BeatstoreSearchPanel",emits:["updateSearchQuery"],setup(c,{emit:n}){const r=S(),e=T({bpm:r.query.bpm?String(r.query.bpm):"",name:r.query.name?String(r.query.name):"",artist:[]});function i(t){e.artist=t}let s;function u(t){const l=t.target;l.value=l.value.replace(/[^\d,]/g,""),clearTimeout(s),o=setTimeout(()=>{e.bpm=l.value},500)}let o;function x(t){const l=t.target;clearTimeout(o),o=setTimeout(()=>{e.name=l.value},750)}return j(e,()=>{const t={};e.bpm&&(t.bpm=e.bpm),e.name&&(t.name=e.name),e.artist&&e.artist.length&&(t.artist=e.artist.join(",")),n("updateSearchQuery",t)}),(t,l)=>(d(),f("div",J,[a("form",K,[a("fieldset",W,[a("input",{id:"bpm","data-test":"bpmInput",type:"number",size:"3",name:"bpm",min:"1",max:"300",placeholder:"1",value:e.bpm,onInput:Q(u,["prevent"]),class:"w-full input input-xs input-bordered focus:outline-none text-black"},null,40,X),Y]),a("fieldset",Z,[a("input",{id:"name","data-test":"nameInput",type:"text",placeholder:"name",name:"nm",value:e.name,onInput:x,class:"w-full input input-xs input-bordered input-primar focus:outline-none focus:border-base-300 text-black"},null,40,ee)]),b(H,{onUpdateArtistQuery:i})])]))}}),se={class:"flex justify-between items-center responsive"},re=a("h1",{class:"text-left text-xl font-semibold mt-5 mb-4 text-black"},"Beats",-1),ae={class:"flex items-center gap-1"},ne={class:"relative"},oe=a("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M112 184l144 144 144-144"},null,-1),ie=[oe],le=F(" Filters "),ce=a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"ionicon w-[14px]",viewBox:"0 -30 512 512"},[a("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M32 144h448M112 256h288M208 368h96"})],-1),ue=[le,ce],de=h({__name:"BeatstoreSearch",emits:["search"],setup(c,{emit:n}){const r=S(),e=m(!1),i=p=>{const _=p.target;e.value=!e.value,V(_,["text-black"])},s=T({ordering:r.query.ordering?String(r.query.ordering):"-id"}),u=p=>{s.ordering!==p&&(s.ordering=p,t.value=!1,A(s))},o=m(),x=m(),t=m(!1),l=m(),g=()=>{t.value=!t.value},M=()=>{document.activeElement!==o.value&&document.activeElement!==x.value&&setTimeout(()=>{t.value=!1},100)},A=p=>{"bpm"in p||delete s.bpm,"name"in p||delete s.name,"artist"in p||delete s.artist,Object.assign(s,p),n("search",`?${new URLSearchParams(s).toString()}`)};return(p,_)=>(d(),f(q,null,[a("div",se,[re,a("div",ae,[a("div",ne,[a("button",{ref:"orderingButton","data-test":"orderingButton",onClick:g,onFocusout:M,class:"flex hover:text-black px-2 rounded-lg text-sm h-[24px] items-center gap-1"},[a("span",{"data-test":"orderingText",class:v(t.value?"text-black":"")},$(s.ordering==="-id"?"New first":"Popular first"),3),(d(),f("svg",{ref:"orderingSvg","data-test":"orderingDown",xmlns:"http://www.w3.org/2000/svg",class:v(["ionicon w-[16px] transition-all",t.value?"rotate-180":""]),viewBox:"0 -40 512 512"},ie,2))],544),k(a("div",{ref_key:"orderingsPanel",ref:l,class:"absolute z-[2] w-[115px] border-full border-[1px] bg-base-100 rounded-md p-2 flex flex-col gap-1 shadow-md right-0"},[a("button",{ref_key:"orderOption1",ref:o,onClick:_[0]||(_[0]=I=>u("-listenings")),class:v(["w-full flex hover:text-black px-2 rounded-lg text-sm items-center gap-1",s.ordering=="-listenings"?"text-black":""])}," Popular first ",2),a("button",{ref_key:"orderOption2",ref:x,onClick:_[1]||(_[1]=I=>u("-id")),class:v(["w-full flex hover:text-black px-2 rounded-lg text-sm items-center gap-1",s.ordering=="-id"?"text-black":""])}," New first ",2)],512),[[w,t.value]])]),a("button",{"data-test":"searchButton",class:"flex hover:text-black px-2 rounded-lg text-sm h-[24px] items-center gap-[6px]",onClick:i},ue)])]),k(b(te,{onUpdateSearchQuery:A},null,512),[[w,e.value]])],64))}}),pe={class:"flex-1 flex flex-col items-center pt-5 pb-[75px] min-h-[calc(100vh-85px)]"},me=h({__name:"BeatstoreBeats",setup(c){const n=R(),r=S(),e=m(!0),i=m(""),s=m([]),u=async(t,l)=>{e.value=!0;const g=(await O.get(t)).data;l?s.value.push(...g.results):s.value=[...g.results],i.value=g.next,e.value=!1},o=async t=>{n.push(`/beats${t}`)},x=()=>{u(i.value,!0)};return j(()=>r.query,()=>{const t=r.query;u(`https://s1kebeatstore-rest.herokuapp.com/api/beats/?${new URLSearchParams(t).toString()}`)}),P(()=>{const t=r.query;u(`https://s1kebeatstore-rest.herokuapp.com/api/beats/?${new URLSearchParams(t).toString()}`)}),(t,l)=>(d(),f("section",pe,[b(de,{onSearch:o}),k(b(L,{class:"flex-1",list:s.value},null,8,["list"]),[[w,!e.value]]),k(b(L,{"data-test":"placeholderList",class:"flex-1",list:[{}]},null,512),[[w,e.value]]),k(a("button",{"data-test":"loadmoreButton",onClick:x,class:"btn bg-black text-white hover:bg-black btn-xs shadow-lg hover:brightness-95 transition-all mt-5"}," Load more ",512),[[w,i.value]])]))}}),he=h({__name:"BeatsView",setup(c){return(n,r)=>(d(),B(me))}});export{he as default};
